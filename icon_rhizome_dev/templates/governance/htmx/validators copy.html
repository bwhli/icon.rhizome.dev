<thead>
    <tr class="text-left bg-gray-900 divide-x-2 divide-gray-800">
        <th id="validator-index" class="whitespace-nowrap px-3 py-2 text-center">#</th>
        <th id="validator-name" class="whitespace-nowrap px-3 py-2">Name</th>
        <th id="validator-cps" class="whitespace-nowrap px-3 py-2 text-center">CPS</th>
        <th id="validator-delegated" class="whitespace-nowrap px-3 py-2">
            <div class="flex justify-between">
                <button id="sort-by-delegated" class="flex"
                    hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=delegated&sort_dir={{ sort_dir }}"
                    hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                    <p>Delegation</p>
                    {% if sort_by == "delegated" %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% if sort_dir == "asc" %}
                    <button id="sort-by-delegated-desc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=delegated&sort_dir=desc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
                        </svg>
                    </button>
                    {% elif sort_dir == "desc" %}
                    <button id="sort-by-delegated-asc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=delegated&sort_dir=asc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                        </svg>
                    </button>
                    {% endif %}
                    {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% endif %}
                </button>
            </div>
        </th>
        <th id="validator-power" class="whitespace-nowrap px-3 py-2">
            <div class="flex justify-between">
                <button id="sort-by-power" class="flex"
                    hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=power&sort_dir={{ sort_dir }}"
                    hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                    <p>Power</p>
                    {% if sort_by == "power" %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% if sort_dir == "asc" %}
                    <button id="sort-by-power-desc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=power&sort_dir=desc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
                        </svg>
                    </button>
                    {% elif sort_dir == "desc" %}
                    <button id="sort-by-power-asc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=power&sort_dir=asc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                        </svg>
                    </button>
                    {% endif %}
                    {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% endif %}
                </button>
            </div>
        </th>
        <th id="validator-bond" class="whitespace-nowrap px-3 py-2">
            <div class="flex justify-between">
                <button id="sort-by-delegated" class="flex"
                    hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=bond_ratio&sort_dir={{ sort_dir }}"
                    hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                    <p>Bond</p>
                    {% if sort_by == "bond_ratio" %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% if sort_dir == "asc" %}
                    <button id="sort-by-bond-ratio-desc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=bond_ratio&sort_dir=desc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
                        </svg>
                    </button>
                    {% elif sort_dir == "desc" %}
                    <button id="sort-by-bond-ratio-asc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=bond_ratio&sort_dir=asc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                        </svg>
                    </button>
                    {% endif %}
                    {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% endif %}
                </button>
            </div>
        </th>
        <th id="validator-productivity" class="whitespace-nowrap px-3 py-2">
            <div class="flex justify-between">
                <button id="sort-by-productivity" class="flex"
                    hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=productivity&sort_dir={{ sort_dir }}"
                    hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                    <p>Productivity</p>
                    {% if sort_by == "productivity" %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% if sort_dir == "asc" %}
                    <button id="sort-by-productivity-desc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=productivity&sort_dir=desc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
                        </svg>
                    </button>
                    {% elif sort_dir == "desc" %}
                    <button id="sort-by-productivity-asc"
                        hx-get="/governance/htmx/validators/?block_number={{ block_number }}&sort_by=productivity&sort_dir=asc"
                        hx-trigger="click" hx-target="#validators" hx-swap="outerHTML">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                            stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                        </svg>
                    </button>
                    {% endif %}
                    {% else %}
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                        stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round"
                            d="M8.25 15L12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
                    </svg>
                    {% endif %}
                </button>
            </div>
        </th>
        <th id="validator-daily-reward" class="whitespace-nowrap px-3 py-2">Daily
            Reward
        </th>
        <th id="validator-monthly-reward" class="whitespace-nowrap px-3 py-2">Monthly
            Reward
        </th>
        <th id="validator-yearly-reward" class="whitespace-nowrap px-3 py-2">Yearly
            Reward
        </th>
    </tr>
</thead>
<tbody class="divide-y-2 divide-gray-800">
    {% for validator in validators %}
    <tr class="text-left divide-x-2 divide-gray-800">
        <td id="{{ validator.address }}-index" class="whitespace-nowrap px-3 py-2 text-center">
            {{ loop.index }}
        </td>
        <td id="{{ validator.address }}-identity" class="whitespace-nowrap px-3 py-2 text-left">
            <div class="flex gap-2">
                <div class="w-12 h-12">
                    {% if (validator.address + "_128px.png") in validator_images %}
                    <img id="{{ validator.address }}-logo"
                        src="/static/images/validators/{{ validator.address }}_128px.png"
                        class="rounded-full border-2 p-0.5 border-gray-800 block" />
                    {% else %}
                    <img id="{{ validator.address }}-logo" src="/static/images/validators/validator_128px.png"
                        class="rounded-full border-2 p-0.5 border-gray-800 block" />
                    {% endif%}
                </div>
                <div class="grow">
                    <p id="{{ validator.address }}-name" class="font-bold">{{ validator.name }}</p>
                    <p id="{{ validator.address }}-address" class="text-cyan-500 text-sm">
                        {{ icx_address.format(validator.address, font_size="text-sm") }}
                    </p>
                </div>
            </div>
        </td>
        <td id="{{ validator.address }}-cps" class="whitespace-nowrap px-3 py-2 text-center">
            {% if validator.cps == True %}
            <p class="text-green-500">YES</p>
            {% else %}
            <p class="text-red-500">NO</p>
            {% endif %}
        </td>
        <td id="{{ validator.address }}-delegated" class="whitespace-nowrap px-3 py-2 text-left">
            {{ format_number(validator.delegated, decimal_places=0) }} ICX
        </td>
        <td id="{{ validator.address }}-power" class="whitespace-nowrap px-3 py-2 text-left">
            {{ format_number(validator.power, decimal_places=0) }} ICX
        </td>
        <td id="{{ validator.address }}-bond" class="whitespace-nowrap px-3 py-2 text-left">

            {% if validator.bond_ratio != 0 %}
            {% if validator.bond_ratio >= 0.05 %}
            {% set bond_ratio_text_color = "text-green-500" %}
            {% elif validator.bond_ratio < 0.05 and validator.bond_ratio > 0.04 %}
            {% set bond_ratio_text_color = "text-yellow-500" %}
            {% elif validator.bond_ratio < 0.04 and validator.bond_ratio > 0.03 %}
            {% set bond_ratio_text_color = "text-orange-500" %}
            {% elif validator.bond_ratio < 0.03 %}
            {% set bond_ratio_text_color = "text-red-500" %}
            {% endif %}
            {% endif %}

            <p class="{{ bond_ratio_text_color }}">
                {{ format_percentage(validator.bond_ratio) }}</p>
            <p class="text-sm text-gray-400">{{ format_number(validator.bonded, decimal_places=0) }} ICX
            </p>
        </td>
        <td id="{{ validator.address }}-productivity" class="whitespace-nowrap px-3 py-2 text-left">
            {% if validator.total_blocks != 0 %}
            {% if validator.productivity > 0.99 %}
            {% set validator_text_color = "text-green-500" %}
            {% elif validator.productivity < 0.99 and validator.productivity > 0.98%}
            {% set validator_text_color = "text-yellow-500" %}
            {% elif validator.productivity < 0.98 and validator.productivity > 0.97%}
            {% set validator_text_color = "text-orange-500" %}
            {% elif validator.productivity < 0.97%}
            {% set validator_text_color = "text-red-500" %}
            {% endif %}
            {% endif %}
            <p class="{{ validator_text_color }}">
                {{ format_percentage(validator.productivity) }}
            </p>
            <p class=" text-sm text-gray-400">
                {{ format_number(validator.validated_blocks) }}/{{ format_number(validator.total_blocks) }}
            </p>
        </td>
        <td id="{{ validator.address }}-daily-reward" class="whitespace-nowrap px-3 py-2 text-left">
            <p>{{ format_number(validator.reward_daily) }} ICX</p>
            <p class="text-sm text-gray-400">
                {{ format_number(validator.reward_daily_usd) }} USD
            </p>
        </td>
        <td id="{{ validator.address }}-monthly-reward" class="whitespace-nowrap px-3 py-2 text-left">
            <p>{{ format_number(validator.reward_monthly) }} ICX</p>
            <p class="text-sm text-gray-400">
                {{ format_number(validator.reward_monthly_usd) }} USD
            </p>
        </td>
        <td id="{{ validator.address }}-yearly-reward" class="whitespace-nowrap px-3 py-2 text-left">
            <p>{{ format_number(validator.reward_daily * 365) }} ICX</p>
            <p class="text-sm text-gray-400">
                {{ format_number(validator.reward_daily_usd * 365) }} USD
            </p>
        </td>
    </tr>
    {% endfor %}
</tbody>